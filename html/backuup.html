<script>
        function getDomainNames() {
              hostName = window.location.hostname;
              rHN = hostName.substring(hostName.indexOf(".")+1,hostName.length);
              ret = rHN.substring(0,rHN.indexOf("."));
              return ret;
        };
  console.log("load wallboard");
  if (parent.window.orientation == 0) {
      var wallboardW = screen.width;
  } else {
      var wallboardW = screen.height;
  }
  var currentID = window.frameElement.getAttribute('id'),
    parentID = parent.document.getElementById(currentID).parentNode.getAttribute('id'),
    topparentID = parent.document.getElementById(parentID).parentNode.getAttribute('id'),
    node = parent.document.getElementById(topparentID);

  var creativeContainer = document.createElement('div');
  creativeContainer.setAttribute("data-info", "ad");
  creativeContainer.setAttribute('id', topparentID + '-cont');
  node.parentNode.insertBefore(creativeContainer, node);

  var myparent = parent.document.getElementById(topparentID + '-cont');
  var parentID = myparent.getAttribute("id");
  console.log(window.frameElemente)
  parent.document.getElementById(currentID).style.height = 0;

  myparent.style.width = wallboardW + "px";
  myparent.style.height = (wallboardW / 7) * 7.5 + 'px';

var addnewstyle = null;

if (typeof(parent.window.kmklabs) !== "undefined") {
  if(document.location.host == "m.bola.com" || parent.kmklabs.site == "liputan6"){
    addnewstyle = "[class*='adslot']{margin-left : -15px}"
  }
}

        if(getDomainNames()==="merdeka")
       {
            myparent.style.marginLeft = "-10px";
       }


  var mystyle = `
    @import url('https://fonts.googleapis.com/css?family=Roboto:100,300,400,700');
    ::-webkit-input-placeholder {
      /* Chrome/Opera/Safari */
      color: #969696 !important;
    }

    @media only screen and (orientation: landscape) {
      #`+topparentID+`-cont {
        margin: 0 auto;
      }
      
      #wallboard-form .wall-form-control {
        margin-top: -10px;
      }

      #wallboard-form .wall-form-control .wall-p{
          padding: .6em 0 0 10% !important;
          font-size : 14px;
      }


    }
    ::-moz-placeholder {
      /* Firefox 19+ */
      color: #969696 !important;
    }

    ::-ms-input-placeholder {
      /* IE 10+ */
      color: #969696 !important;
    }

    ::-moz-placeholder {
      /* Firefox 18- */
      color: #969696 !important;
    }

    ::placeholder {
      /* Firefox 18- */
      color: #969696 !important;
    }

    div#div-gpt-ad-kapanlagi-sc-cont,
    div#div-gpt-ad-vemale-sc-cont {
      margin: 0 auto;
    }

    #wallboard {
      width: 100%;
      height: 100%;
      position: relative;
      font-family: 'Roboto', serif;
      margin: 0 auto;
    }

    #wallboard p,
    #wallboard input {
      font-family: 'Roboto', serif;
      font-size: 15px;
      line-height: 25px;
    }

    .wallboard_link {
      display: block;
      width: 100%;
    }

    .wallboard_img {
      width: 360px;
      margin: -1em auto;
      display: block;
    }

    #wallboard .wallboard-survey {
      float: left;
      width: 100%;
      height: 100%;
      box-sizing: border-box;
      background-size: cover;
      position: absolute;
      overflow: hidden;
      white-space: nowrap;
    }

    #wallboard .wallboard-survey .wall-item {
      display: inline-block;
      width: 100%;
      min-height: 100%;
      position: relative;
      white-space: normal;
      transition: margin-left .5s;
    }

    .wall-item.wallboard-survey-content h3 {
      display: block;
      width: 90%;
      float: left;
      margin: 50% 5% 0;
      /* margin-top: 50%; */
      transform: translate(0, -50%);
      color: #fff;
      font-family: roboto;
      font-size: 25px;
      line-height: 35px;
      text-align: center;
    }

    #wallboard .wallboard-survey .wall-item .item-content {
      position: absolute;
      width: 100%;
      height: 100%;
      box-sizing: border-box;
    }

    .active {
      display: block;
    }

    .deactive {
      display: none;
    }

    .wallboard-survey-success,
    .wallboard-survey-gateway {
      box-sizing: border-box;
      top: 0;
      left: 0;
      bottom: 0;
      right: 0;
      height: 100%;
      background-size: cover;
    }

    #loading-data {
      position: absolute;
      height: 100%;
      top: 0;
      left: 0;
      width: 100%;
      z-index: 10;
      background: rgba(0, 0, 0, .4);
      visibility: hidden;
    }

    #loading-data img {
      display: block;
      width: 30px;
      margin: 175px auto;
    }

    .wallboard-survey-gateway .item-content img {
      float: left;
      display: block;
      width: 60%;
      padding: 0 20%;
    }

    .wallboard-survey-gateway .item-content h3 {
      font-size: 22px;
      display: block;
      font-weight: 700;
      text-transform: capitalize;
      color: #fff;
      text-align: center;
      width: 80%;
      margin: 7vh 10%;
    }

    .wall-item.wallboard-survey-content .text-after-survey {
      margin: 7vh 5% 0;
      /*DONI BARU*/
      transform: translate(0, 0);
      position: absolute;
      color: #fff;
      font-size: 20px;
      font-family: roboto;
      font-weight: 400;
      width: 90%;
    }

    .wallboard-survey-gateway .item-content img {
      height: 10vh;
      width: auto;
      display: block;
      margin: 15vh auto 1.5vh;
    }

    .wallboard-survey-success .title,
    .wallboard-survey-gateway .item-content .title {
      display: block;
      margin: 0 auto .5em;
      text-align: center;
      font-size: 1.2em;
    }

    .wallboard-survey-gateway .item-content .title {
      width: 70%;
    }

    .wallboard-survey-success .title p {
      font-weight: bold;
      width: 100%;
      color: #444;
      font-size: 20px;
      white-space: normal;
    }

    .wallboard-survey-gateway .item-content .control {
      width: 100%;
      flex-basis: 12;
    }

    .wallboard-survey-gateway .item-content .control #msg-gateway {
      display: block;
      width: 80%;
      text-align: center;
      margin: 1em auto;
      font-size: 12px;
      color: red;
    }

    .wallboard-survey-gateway .item-content .control .btn {
      border: none;
      line-height: 2em;
      border-radius: 5px;
    }

    .wallboard-survey-content .item-content .control .index {
      float: right;
      box-sizing: border-box;
      font-size: 1em;
      line-height: 30px !important;
      margin: 0;
      color: #fff;
    }

    .wallboard-survey-content .item-content .control .index span {
      margin: 0 5px;
    }

    .wallboard-survey-gateway .item-content .btn {
      display: block;
      width: 100px;
      margin: 0 auto;
      border: none;
      padding: 10px;
    }

    .wallboard-survey-content .item-content .control {
      width: 90%;
      position: absolute;
      bottom: 1em;
      left: 5%;
      right: 5%;
      overflow: hidden;
      padding: 5px 0;
    }

    .wallboard-survey-content .item-content .control .btn {
      padding: 0;
      border: none;
      height: 30px;
      border-radius: 10px;
      background: transparent !important;
    }

    .wallboard-survey-content .item-content .control .btn p {
      float: left;
      font-size: 1em;
      margin: 0;
      color: #ee3f60;
    }

    .wallboard-survey-content .item-content .control .btn img {
      float: right;
      height: 30px;
    }

    #wall-popup-footer .vote,
    #control-next,
    #control-prev,
    #control-submit {
      background: #7f0fff;
    }

    #control-next,
    #control-yes {
      color: #ececec;
    }

    #control-prev {
      transition: all .5s;
      float: left;
    }

    #control-submit,
    #control-next {
      color: #ececec;
      float: right;
      margin-right: -100%;
      transition: margin-right .5s;
    }

    .wallboard-survey-content .item-content .content {
      white-space: nowrap;
      position: relative;
      overflow: hidden;
      min-height: 350px;
      margin-left: 0;
      transition: margin-left .5s;
    }

    .wall-item .item-content .content .page {
      white-space: normal;
      height: auto;
      width: 100%;
      transition: margin-left .5s;
      transition-delay: .1s;
      display: inline-block;
    }

    .wall-item .item-content .content .page .wall-container {
      /*border: solid 1px red;*/
      position: absolute;
      background: transparent;
      top: 0;
      width: 100%;
    }

    .wall-item .item-content .content .page .wall-container .title {
      display: block;
      width: 90%;
      margin: 15px auto;
      font-size: 15px !important;
      line-height: 20px !important;
      color: #444 !important;
      text-align: left;
      font-weight: 700;
    }

    .wall-item .item-content .content .page .wall-container .wall-form-control {
      display: block;
      width: 100%;
      height: auto;
      float: left;
    }

    .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control-vid,
    .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control-img {
      float: left;
      width: 50%;
      margin-bottom: .25em;
    }

    .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control-vid {
      margin-top: 0;
    }

    .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control-vid .checked,
    .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control-img .checked {
      position: absolute;
      height: 100%;
      background: rgba(0, 0, 0, .5);
      box-sizing: border-box;
      padding: 20%;
      opacity: 0;
      transition: opacity .5s
    }

    .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control-vid .magnify {
      position: absolute;
      height: 100%;
      background: rgba(0, 0, 0, .5);
      box-sizing: border-box;
      padding: 20%;
      opacity: 1;
      transition: opacity .5s
    }

    .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control-vid .magnify,
    .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control-vid .checked {
      padding: 13% 30%;
    }

    .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control-vid input[type="radio"],
    .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control-img input[type="radio"] {
      position: absolute;
      z-index: 5;
      height: 100%;
      opacity: 0;
    }

    .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control-vid input[type="radio"]:checked~.checked,
    .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control-img input[type="radio"]:checked~.checked {
      opacity: 1;
    }

    .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control-vid input[type="radio"]:checked~.magnify {
      opacity: 0;
    }

    .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control-img:nth-child(odd) input[type="radio"] {
      margin-left: -15%;
    }

    .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control-img:nth-child(odd) .checked {
      float: right;
      margin-left: 5px;
    }

    .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control-img:nth-child(even) input[type="radio"] {
      margin-left: -45%;
    }

    .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control-img:nth-child(even) .checked {
      float: left;
      margin-right: 5px;
    }

    .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control-vid:nth-child(odd) img,
    .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control-img:nth-child(odd) img {
      float: right;
      right: 5%;
    }

    .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control-vid:nth-child(even) img,
    .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control-img:nth-child(even) img {
      float: left;
      left: 5%;
    }

    .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control-vid div,
    .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control-img div {
      position: relative;
      float: left;
      margin: 0 auto 5px;
      display: block;
    }

    .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control-vid img,
    .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control-img img {
      position: relative;
      display: inline;
    }

    .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control-img img,
    .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control-img input[type="radio"],
    .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control-img .checked {
      width: 60%;
    }

    .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control-vid img,
    .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control-vid input[type="radio"],
    .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control-vid .checked {
      width: 80%;
    }

    .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control-vid input[type="radio"] {
      display: none;
    }

    .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control-vid:nth-child(even) .wall-p,
    .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control-img:nth-child(even) .wall-p {
      float: left;
      margin-left: 5%;
    }

    .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control-vid:nth-child(odd) .wall-p,
    .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control-img:nth-child(odd) .wall-p {
      margin-right: 5%;
      float: right;
    }

    .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control-vid .wall-p,
    .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control-img .wall-p {
      display: block;
      width: 55%;
      color: #fff;
      font-size: 14px;
      margin: 0;
    }

    .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control-img .wall-p {
      text-align: center;
      overflow: hidden;
    }

    .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control-vid .wall-p {
      width: 80%;
      word-wrap: normal;
      text-align: left;
      line-height: 1em;
      margin-bottom: 1em;
    }

    .wall-input-control {
      width: 90%;
      margin: 8px auto;
      display: flex;
      flex-direction: row;
      border-radius: 5px;
      background: #fff;
    }

    .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control input[type="checkbox"],
    .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control input[type="radio"] {
      float: right;
      height: 1.2em;
      margin: .8em;
      z-index: 2;
      padding-left: 80%;
    }

    .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control textarea {
      float: left;
      width: 100%;
      min-height: 30vh;
      border: none;
      box-sizing: border-box;
      padding: .5em;
      font-size: 18px;
      font-family: 'Roboto', serif;
      color: #444;
      /*#212121;doni*/
      font-weight: 400;
    }

    .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control input[type="text"]::-webkit-input-placeholder,
    .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control input[type="email"]::-webkit-input-placeholder,
    .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control input[type="tel"]::-webkit-input-placeholder,
    .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control input[type="number"]::-webkit-input-placeholder {
      color: #fff;
    }

    .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control input[type="text"],
    .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control input[type="email"],
    .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control input[type="tel"],
    .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control input[type="date"],
    .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control input[type="number"] {
      display: block;
      width: 100%;
      border: none;
      box-sizing: border-box;
      padding: .6em 1em;
      text-align: left;
      font-size: 18px;
      background: transparent;
      color: #444;
      /*#969696;doni*/
      ;
      border: solid 1px #fff;
      border-radius: 5px;
      height: 100%;
      margin: 0;
      font-weight: 400;
    }

    .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control .wall-p {
      z-index: 2;
      position: absolute;
      vertical-align: middle;
      width: 90%;
      color: #444;
      /*#212121;doni*/
      font-size: 1.05em;
      font-weight: 400;
      box-sizing: border-box;
      text-align: left;
      margin: 0 !important;
    }

    .wallboard-survey-success .content {
      padding: 10%;
    }

    .wallboard-survey-success img {
      display: block;
      height: 10vh;
      margin: 10vh auto 1em;
    }

    #wallboard-popup {
      display: none;
      position: fixed;
      visibility: hidden;
      opacity: 0;
      z-index: 1000;
      background: rgba(0, 0, 0, .85);
      width: 100%;
      height: 100%;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      display: flex;
      flex-direction: column;
      flex-basis: 12;
      transition: opacity .5s;
    }

    #wallboard-popup #close {
      position: absolute;
      z-index: 10;
      top: 1em;
      right: 1em;
      height: 20px;
    }

    #wall-popup-logo,
    #wall-popup-content,
    #wall-popup-footer {
      white-space: normal;
      box-sizing: border-box;
      flex: 12;
    }

    #wall-popup-logo img {
      display: block;
      width: 40%;
      margin: 10vh auto 0;
    }

    #wall-popup-content iframe {
      width: 90%;
      height: 40vh;
      display: none;
      margin: 0 auto;
    }

    #wall-popup-footer .vote {
      border: none;
      display: block;
      padding: 1em;
      font-size: 1.2em;
      width: 30%;
      color: #fff;
      margin: 10vh 35%;
    }

    div#autocomplete-list,
    div#Kotaautocomplete-list {
      position: absolute;
      width: 90%;
      background: rgba(255, 255, 255, 1);
      z-index: 1000;
      margin-top: 40px;
      color: #212121;
      border-radius: 5px;
      height: 50vh;
      overflow: scroll;
    }

    div#autocomplete-list div ,
    div#Kotaautocomplete-list div {
      box-sizing: border-box;
      padding: 10px;
      border-bottom: solid 1px #ececec;
      text-align: left;
    }

    @media only screen and (max-width: 320px) {
      .wall-item .item-content .content .page .wall-container .title {
        font-size: 1em;
      }
      .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control-img {
        margin-bottom: 0;
      }
      .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control-vid {
        margin: 1em 0 0;
      }
      .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control-vid .wall-p,
      .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control-img .wall-p {
        font-size: 12px;
        line-height: 13px;
      }
      .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control .wall-p {
        font-size: 14px !important;
        line-height: 15px !important;
      }
      .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control input[type="checkbox"],
      .wall-item .item-content .content .page .wall-container .wall-form-control .wall-input-control input[type="radio"] {
        margin: .5em;
      }
    }

    @media only screen and (orientation: landscape) {
      #wallboard-popup {
        flex-direction: row;
      }
      #wall-popup-footer,
      #wall-popup-logo {
        flex: 3
      }
      #wall-popup-content {
        flex: 6
      }
      #wall-popup-logo img {
        width: auto;
        height: 20vh;
        margin: 40vh auto;
      }
      #wall-popup-content iframe {
        height: 50vh;
        width: auto;
        margin: 25vh auto;
      }
      #wall-popup-footer .vote {
        height: 15vh;
        width: 80%;
        margin: 42.5vh auto;
        box-sizing: border-box;
      }
    }

    .wall-container.grouping {
      margin: 50px 0;
    }

    p.title.group {
      margin: 10px auto !important;
    }
  `;
  var myscript = `\
    var databacktopage;
    /* dfp variable */
    var dfpCachebuster = Math.random(new Date().getTime() / (300 * 1000));
    var dfpCampaignName = "event_sekolah_desember_11122018";
    var dfpGradientColor = "#fff";
    var dfpSmallLogo = "<img src='https://d.kapanlaginetwork.com/banner/preview/2017/12/13/wallboard/survey/kl.png'>"
    var dfpContetnBgImage = "%%FILE:dfpContetnBgImage%%";
    var dfpGatewayBG = "%%FILE:dfpGatewayBG%%";

    var dfp_clickTracker = "%%CLICK_URL_UNESC%%http://cdn.klimg.com/d.kapanlaginetwork.com/banner/asset/img/pixel.png";

    var dfpUrlGet = "https://www.newshub.id/api/interactive-content/722/&token=06c0cb9bc610871859140e9c1c04808c&cb=" + dfpCachebuster;
    var dfpUrlsubmit = "https://www.newshub.id/app/record-interactive&cb=" + dfpCachebuster;

    var defaultCookieDuration = 10;

    var wallboardDiv = document.querySelector("#wallboard");
    var mainSurvey = document.querySelector("#wallboard .wallboard-survey");
    var popupSurvey = document.querySelector("#wallboard .wallboard-survey #wallboard-popup");
    /* gateway*/
    var surveyGatwayDiv = document.querySelector("#wallboard .wallboard-survey .wallboard-survey-gateway");
    var gatewayContent = document.querySelector("#wallboard .wallboard-survey .wallboard-survey-gateway .item-content");
    /*content */
    var surveyContentDiv = document.querySelector("#wallboard .wallboard-survey .wallboard-survey-content");
    var contentSurvey = document.querySelector("#wallboard .wallboard-survey .wallboard-survey-content .content");
    /* message */
    var surveySuccessDiv = document.querySelector("#wallboard .wallboard-survey .wallboard-survey-success");
    var surveyErrorDiv = document.querySelector("#wallboard .wallboard-survey .wallboard-survey-error");
    var surveyPopupLogoDiv = document.querySelector("#wallboard .wallboard-survey #wallboard-popup #wall-popup-logo");

    var loading = document.getElementById("loading-data");

    var buttonNext = document.getElementById("control-next");
    var buttonPrev = document.getElementById("control-prev");
    var buttonYes = document.getElementById("control-yes");
    var buttonNo = document.getElementById("control-no");
    var buttonSumbit = document.getElementById("control-submit");

    var msgGateway = document.getElementById("msg-gateway");

    var indexSurvey = document.getElementById("index-survey");
    var totalSurvey = document.getElementById("total-survey");
    var writtenAnswerHTML = "";
    var pages;
    var jsonData;
    var nextIndex;
    var prevIndex;
    var CountPageSurvey;

    var surveyStatus = false;
    var checkRadio = [];
    var isFilled = [];
    var currentIndex; /*NEW*/
    var questionLength /*nova*/
    var newquestinlength /*nova*/
    /* step 5 */
    var inputlength = 0; /*nova*/
    var newTemplate = ""; /*nova*/
    var onInitState = getCookieValue("wallboard-survey-" + dfpCampaignName);

    /* var visualSubmitFeedback =" ";*/
    buttonSumbit.addEventListener("click", function(){
      this.click();
    })

    /* uc browser checker */
    var nua = navigator.userAgent;
    var uc = nua.indexOf('UCBrowser') > -1;
    var wallpInLine = (uc) ? "style= 'padding : .6em 5%'" : "style='padding : .6em 10%'";


    /* 
      ======================= 
        function section
      ======================= 

      init ads survey cookie
    */
    initSurvey()

    function initSurvey() {
        wallboardWidth()
        /*
          if null set cooking live time 10 minute
          set bg gateway and add event to strat survey
          setting gradient color
          mainSurvey.style.background = "linear-gradient("+dfpGradientColor+")";
        */
        mainSurvey.style.backgroundImage = "url(" + dfpContetnBgImage + ")";

        /* setting btn color */
        var mybtn = document.querySelectorAll("#wallboard .btn");
        var newcolor = dfpGradientColor.split(",");
        if (dfpGradientColor != null) {
            mybtn.forEach(function(o, i) {
                o.style.background = newcolor[0]
            })
        }

        if (onInitState == null) {

            var nowDate = new Date();
            nowDate.setHours(nowDate.getHours(), nowDate.getMinutes() + defaultCookieDuration);
            cookieExpires = nowDate.toGMTString();
            setCookie("wallboard-survey-" + dfpCampaignName, true, "/", cookieExpires)
            surveyGatwayDiv.addEventListener("click", startSurvey);
            surveyGatwayDiv.style.backgroundImage = "url('" + dfpGatewayBG + "')";
            surveyPopupLogoDiv.innerHTML = dfpSmallLogo;

        } else if (onInitState == "true") {
            surveyGatwayDiv.addEventListener("click", startSurvey);
            surveyGatwayDiv.style.backgroundImage = "url('" + dfpGatewayBG + "')";

        } else if (onInitState == "false") {
            surveyGatwayDiv.addEventListener("click", startSurvey);
            surveyGatwayDiv.style.backgroundImage = "url('" + dfpGatewayBG + "')";
        }
    }

    function getDomainName() {
        hostName = window.location.hostname;
        return rHN = hostName;
    }

    function setCookie(cookieName, cookieValue, cookiePath, cookieExpires) {
        var cookieValue = escape(cookieValue);
        var banner_cookieDomain = getDomainName();

        if (cookiePath != "") {
            cookiePath = ";Path=" + cookiePath;
        }
        document.cookie = cookieName + "=" + cookieValue + ";expires=" + cookieExpires + cookiePath + ";Domain=" + banner_cookieDomain;
    }

    function getCookieValue(cookieName) {
        var cookieValue = document.cookie;
        var cookieStartsAt = cookieValue.indexOf(" " + cookieName + "=");
        if (cookieStartsAt == -1) {
            cookieStartsAt = cookieValue.indexOf(cookieName + "=");
        }
        if (cookieStartsAt == -1) {
            cookieValue = null;
        } else {
            cookieStartsAt = cookieValue.indexOf("=", cookieStartsAt) + 1;
            var cookieEndsAt = cookieValue.indexOf(";", cookieStartsAt);
            if (cookieEndsAt == -1) {
                cookieEndsAt = cookieValue.length;
            }
            cookieValue = unescape(cookieValue.substring(cookieStartsAt, cookieEndsAt));
        }
        return cookieValue;
    }

    function wallboardWidth() {
        if (window.orientation == 0) {
            var wallboardW = screen.width;
        } else {
            var wallboardW = screen.height;
        }
        wallboardDiv.style.width = wallboardW + "px";
        wallboardDiv.style.height = (wallboardW / 7) * 7.5 + "px";
    }

    /* step 2 */
    function startSurvey() {
        if (onInitState == "false") {
            surveyGatwayDiv.style.marginLeft = "-100%";
            surveyContentDiv.innerHTML = "<h3>Maaf, email kamu telah terdaftar sebelumnya. Terimakasih</h3>";
        } else {
            nextIndex = 0;
            buttonPrev.style.marginLeft = "-100%";
            generateSurvey();
            indexSurvey.innerHTML = nextIndex + 1;
            createTracker("beauty-event");
            createTracker("lifestyle-event");
            createTracker("women-event");
            createTracker("beauty-content");
        }
    }

    /* step 3 */
    function generateSurvey() {
        getJSON(dfpUrlGet, function(err, data) {
            /*check if data receive*/
            if (err !== 200) {
                /* if no*/
                msgGateway.innerHTML = "gagal menyambungkan, silahkan coba lagi !";
                loading.style.visibility = "hidden";
            } else {
                /* if yes*/
                jsonData = data;
                if (!surveyStatus) {
                    generateQuestion(data);
                    surveyStatus = true;
                }

                surveyGatwayDiv.classList.remove("active");
                surveyGatwayDiv.classList.add("deactive");
                surveyContentDiv.classList.remove("deactive");
                surveyContentDiv.classList.add("active");
                surveyGatwayDiv.style.marginLeft = "-100%";

                var click = document.createElement("img");
                click.src = dfp_clickTracker;
                click.style.width = "0";
                click.style.height = "0";
                click.style.visibility = "hidden";
                wallboardDiv.appendChild(click);
            }
        });
    }

    /* step 4 */
    function getJSON(url, callback) {
        var xhr = new XMLHttpRequest();
        xhr.open('GET', url, true);
        xhr.responseType = 'json';
        xhr.onload = function() {
            var status = xhr.status;
            if (status === 200) {
                callback(status, xhr.response);
            } else {
                callback(status, xhr.response);
            }
        };
        xhr.send();
    };

    /* step 5 */
    function generateQuestion(data) {
        var questionHTML = "";
        questionLength = data.survey.length; /*nova*/


        var write_answer_length_in_page = 0;
        /* data.survey.length */
        for (var i = 0; i < questionLength /*nova*/ ; i++) {
            var dataType = data.survey[i].option_type;
            checkRadio.push([]);
            isFilled.push([]);

            switch (dataType) {
                case "written_answer":
                  if (write_answer_length_in_page == 3) {
                    write_answer_length_in_page = 0;
                  }
                    var isLong = (data.survey[i].written_type == "long") ? "long" : "short";
                    try {
                        if (data.survey[i + 1].option_type == 'written_answer' && data.survey[i + 1].written_type == 'short' && write_answer_length_in_page < 3) {
                            writtenAnswerHTML += createInputText(data.survey[i], i, isLong, data.survey[i].validation);
                              console.log(i + " try if " + write_answer_length_in_page);
                            write_answer_length_in_page++;
                            if (write_answer_length_in_page == 2) {
                               questionHTML += '<div class="page ">' +
                                    '<div class="wall-container">' +
                                    '<div class="wall-form-control">' +
                                    writtenAnswerHTML +
                                    '</div>' +
                                    '</div>' +
                                    '</div>' +
                                    '</div>';
                                    writtenAnswerHTML = "";
                            }
                        } else {
                            if (data.survey[i].option_type == 'written_answer' && write_answer_length_in_page < 3) {
                                writtenAnswerHTML += createInputText(data.survey[i], i, isLong, data.survey[i].validation);
                                console.log(i + " try else " + write_answer_length_in_page);
                                write_answer_length_in_page++;
                                questionHTML += '<div class="page ">' +
                                    '<div class="wall-container">' +
                                    '<div class="wall-form-control">' +
                                    writtenAnswerHTML +
                                    '</div>' +
                                    '</div>' +
                                    '</div>' +
                                    '</div>';
                                    writtenAnswerHTML = "";
                                    write_answer_length_in_page = 0;
                            }
                        }

                    } catch (err) {
                        if (data.survey[i].option_type == 'written_answer' && write_answer_length_in_page < 3) {
                            writtenAnswerHTML += createInputText(data.survey[i], i, isLong, data.survey[i].validation);
                              console.log(i + " catch " + write_answer_length_in_page);
                        }
                        questionHTML += '<div class="page ">' +
                            '<div class="wall-container">' +
                            '<div class="wall-form-control">' +
                            writtenAnswerHTML +
                            '</div>' +
                            '</div>' +
                            '</div>' +
                            '</div>';
                            write_answer_length_in_page = 0;
                    }
                    break;
                case "text":
                    if (data.survey[i].is_multiple_choice == 0) {
                        if (i == 0) {
                            questionHTML = createInputSelect(data.survey[i], i, "radio");
                        } else {
                            questionHTML += createInputSelect(data.survey[i], i, "radio");
                        }
                    } else {
                        if (i == 0) {
                            questionHTML = createInputSelect(data.survey[i], i, "checkbox");
                        } else {
                            questionHTML += createInputSelect(data.survey[i], i, "checkbox");
                        }
                    }
                    writtenAnswerHTML = "";

                    break;

                case "date2":
                console.log('date type');
                    questionHTML += '<div class="page ">' +
                        '<div class="wall-container">' +
                        '<div class="wall-form-control">' +
                        createInputText(data.survey[i], i, "date", data.survey[i].validation) +
                        '</div>' +
                        '</div>' +
                        '</div>' +
                        '</div>';
                    break;

                case "select_option":
                    if (i == 0) {
                        questionHTML = createInputSelect(data.survey[i], i, "checkbox");
                    } else {
                        questionHTML += createInputSelect(data.survey[i], i, "checkbox");
                    }
                    writtenAnswerHTML = "";

                    break;
                case "photo":
                    if (i == 0) {
                        questionHTML = createInputSelect(data.survey[i], i, "radio");
                    } else {
                        questionHTML += createInputSelect(data.survey[i], i, "radio");
                    }
                    writtenAnswerHTML = "";

                    break;

                case "video":
                    if (i == 0) {
                        questionHTML = createInputSelect(data.survey[i], i, "radio");
                    } else {
                        questionHTML += createInputSelect(data.survey[i], i, "radio");
                    }
                    writtenAnswerHTML = "";
                    break;
            }

            contentSurvey.innerHTML = questionHTML;
            pages = document.querySelectorAll("#wallboard .wallboard-survey .wallboard-survey-content .content .page"); //nova
            CountPageSurvey = pages.length; /*nova*/

            totalSurvey.innerHTML = CountPageSurvey;
            for (p = 1; p <= pages.length; p++) {
                pages[p - 1].setAttribute('data-page', p);
            }

            var allinput = document.querySelectorAll("input");
            var allTextArea = document.querySelectorAll("textarea");

            allinput.forEach(function(v, i){
              if(v.getAttribute("type") == "date"){
                v.valueAsDate = new Date();
              }

            })


        }
        generateAutocomplate();
    }

    /* step 6 a */
    function createInputText(data, index, type, valType) {

        if (inputlength == 0) {
            newTemplate = ""
        }

        var inputType;
        if (valType == null || valType == "undefined") {
            inputType = "text";
        } else {
            switch (valType[0]) {
                case "numeric":
                    inputType = "tel"
                    break;
                case "email":
                    inputType = "email"
                    break;
                case "date":
                    inputType = "date"
                    break;
                default:
                    inputType = "text"
                    break;
            }
        }

        var template = (type == "long") ? '<textarea name="page-' + index + '" onkeyup="onValidateInput(this, \\'' + valType + '\\')" data-validate="false"></textarea>' : (type == "date") ? '<input onfocus="WS_setviewport()" type="date" value="2018-01-01" class="liftsticker-survey-input-text" name="page-' + index + '" onchange="onValidateInput(this ,\\'text\\', event)" id="' + data.text + '" data-validate="false" >' :'<input onfocus="WS_setviewport()" type="' + inputType + '" class="liftsticker-survey-input-text" name="page-' + index + '" onkeyup="onValidateInput(this , \\'' + valType + '\\', event)" id="' + data.text + '"  data-validate="false" >';
        /*nova*/

        return '<p class="title">' + data.text + '</p><div class="wall-input-control">' + template + '</div>';
    }

    function checkNext(event) {}
    /* step 6 b */
    function createInputSelect(data, index, type) {
        var isActive;
        var isPhoto = (data.option_type == "photo") ? createRadioPhoto(data, index, type) : (data.option_type == "video") ? createRadioVideo(data, index, type) : createRadio(data, index, type);
        if (index == 0) {
            isActive = "active";
        } else {
            isActive = "active";
        }
        var template = '<div class="page ' + isActive + '">' +
            '<div class="wall-container">' +
            '<p class="title">' + data.text + '</p>' +
            '<div class="wall-form-control">' +
            isPhoto +
            '</div>' +
            '</div>' +
            '</div>';
        return template;
    }

    function createRadio(data, index, type) {
        var choise;
        var typeIs = (type == "radio") ? 'onClick="nextSurvey()"' : 'onClick="boxChecked()"';
        for (var i = 0; i < data.answers.length; i++) {
            if (i == 0) {
                choise = '<div class="wall-input-control" ' + typeIs + ' >' +
                    '<input type="' + type + '" name="page-' + index + '" value="' + data.answers[i].id + '">' +
                    '<p class="wall-p" id="' + type + '-' + index + i + '" ' + wallpInLine + '>' + data.answers[i].text + '</p>' +
                    '</div>';
            } else {
                choise += '<div class="wall-input-control" ' + typeIs + '>' +
                    '<input type="' + type + '" name="page-' + index + '" value="' + data.answers[i].id + '">' +
                    '<p class="wall-p" id="' + type + '-' + index + i + '" ' + wallpInLine + '>' + data.answers[i].text + '</p>' +
                    '</div>';
            }
        }
        return choise;
    }

    function createRadioPhoto(data, index, type) {
        var choise;
        var typeIs = (type == "radio") ? 'onClick="nextSurvey()"' : 'onClick="boxChecked()"';
        for (var i = 0; i < data.answers.length; i++) {
            if (i == 0) {
                choise = '<div class="wall-input-control-img" ' + typeIs + ' >' +
                    '<div>' +
                    '<input type="' + type + '" name="page-' + index + '" value="' + data.answers[i].id + '">' +
                    '<p hidden >' + data.answers[i].text + '</p>' +
                    '<img  id="' + type + '-' + index + i + '" src="' + data.answers[i].media + '">' +
                    '<img src="https://d.kapanlaginetwork.com/banner/preview/2017/12/13/wallboard/survey/centang.png" alt="" class="checked">' +
                    '</div>' +
                    '<p class="wall-p">' + data.answers[i].text + '</p>' +
                    '</div>';
            } else {
                choise += '<div class="wall-input-control-img" ' + typeIs + '>' +
                    '<div>' +
                    '<input type="' + type + '" name="page-' + index + '" value="' + data.answers[i].id + '">' +
                    '<p hidden >' + data.answers[i].text + '</p>' +
                    '<img  id="' + type + '-' + index + i + '" src="' + data.answers[i].media + '">' +
                    '<img src="https://d.kapanlaginetwork.com/banner/preview/2017/12/13/wallboard/survey/centang.png" alt="" class="checked">' +
                    '</div>' +
                    '<p class="wall-p">' + data.answers[i].text + '</p>' +
                    '</div>';
            }
        }
        return choise;
    }

    function createRadioVideo(data, index, type) {
        var choise;
        for (var i = 0; i < data.answers.length; i++) {
            /* get video url from api */
            var myurl = data.answers[i].media;
            /* split video url to get video id */
            var videoId = myurl.split("/")

            if (i == 0) {
                choise = '<div class="wall-input-control-vid" onClick="showPopup("' + myurl + '","video","' + type + '-' + index + i + '")">' +
                    '<div>' +
                    '<input id="' + type + '-' + index + i + '" type="' + type + '" name="page-' + index + '" value="' + data.answers[i].id + '" >' +
                    '<p hidden >' + data.answers[i].text + '</p>' +
                    '<img   src="https://i.ytimg.com/vi/' + videoId[videoId.length - 1] + '/mqdefault.jpg">' +
                    '<img src="https://d.kapanlaginetwork.com/banner/preview/2017/12/13/wallboard/survey/centang.png" alt="" class="checked">' +
                    '<img src="https://d.kapanlaginetwork.com/banner/preview/2017/12/13/wallboard/survey/magnify.png" alt="" class="magnify">' +
                    '</div>' +
                    '<p class="wall-p">' + data.answers[i].text + '</p>' +
                    '</div>';
            } else {
                choise += '<div class="wall-input-control-vid" onClick="showPopup("' + myurl + '","video","' + type + '-' + index + i + '")">' +
                    '<div>' +
                    '<input id="' + type + '-' + index + i + '" type="' + type + '" name="page-' + index + '" value="' + data.answers[i].id + '" >' +
                    '<p hidden >' + data.answers[i].text + '</p>' +
                    '<img src="https://i.ytimg.com/vi/' + videoId[videoId.length - 1] + '/mqdefault.jpg">' +
                    '<img src="https://d.kapanlaginetwork.com/banner/preview/2017/12/13/wallboard/survey/centang.png" alt="" class="checked">' +
                    '<img src="https://d.kapanlaginetwork.com/banner/preview/2017/12/13/wallboard/survey/magnify.png" alt="" class="magnify">' +
                    '</div>' +
                    '<p class="wall-p">' + data.answers[i].text + '</p>' +
                    '</div>';
            }
        }
        return choise;
    }

    function boxChecked(e) {
        e = e || window.event;
        var targetId = e.target.id;
        /* node get elemen checkbox or radio */
        var node = document.getElementById(targetId).previousSibling.checked;
        if (node == false) {
            /* if not checked */
            document.getElementById(targetId).previousSibling.checked = true;
            /*
             add value to array
             to check if the question need button or not
            */
            checkRadio[nextIndex].push(true);
            isFilled[nextIndex].push(true);

            if (nextIndex < CountPageSurvey - 1) {
                buttonNext.style.marginRight = "0";
            } else if (nextIndex == CountPageSurvey - 1) {
                showSubmit()
            }

        } else {
            /* if checked */
            document.getElementById(targetId).previousSibling.checked = false;
            /* remove value to array */
            checkRadio[nextIndex].pop();
            isFilled[nextIndex].pop();

            /* if value length 0 */
            if (nextIndex < CountPageSurvey - 1) {
                if (checkRadio[nextIndex].length == 0) {
                    /* botton hide */
                    buttonNext.style.marginRight = "-100%";
                }
            } else if (nextIndex == CountPageSurvey - 1) {
                showSubmit()
            }

        }
    }

    function onValidateInput(obj, validType, e) {
        var validationRun = false;
        var currentObj = obj;
        switch (validType) {
            case "email":
                validationRun = validationEmail(currentObj.value);
                break;
            case "numeric":
                validationRun = validateNumber(currentObj.value);
                break;
            default:
                var regex = /^\\s/g;
                var str = currentObj.value;
                if (regex.exec(str) == null) {
                    validationRun = true;
                } else {
                    validationRun = false;
                }
                break;
        }

        if (currentObj.value !== "") {
            if (validationRun) {
                var validData;
                currentObj.dataset.validate = "true";
                validateFieldValue(currentObj, function(data) {
                    validData = data;
                })
            } else {
                currentObj.dataset.validate = "false";
            }
        } else {
            currentObj.dataset.validate = "false";
        }
        getActionAbutton(obj, validType, e, validData);
    }

    function validateFieldValue(e, callback) {
        var el = e.parentElement.parentElement.parentElement.querySelectorAll(".liftsticker-survey-input-text");
        var allFieldDilled = [];
        var trueLength = 0;
        for (var i = 0; i < el.length; i++) {
            if (el[i].dataset.validate == "true") {
                var data = {
                    [el[i].id]: true
                };
            } else {
                var data = {
                    [el[i].id]: false
                };
            }
            allFieldDilled.push(data);
        }

        for (var i = 0; i < allFieldDilled.length; i++) {
            if (el[i].dataset.validate == "true") {
                trueLength++;
            }
        }

        if (trueLength == el.length) {
            callback(true);
        }

    }

    function getActionAbutton(obj, validType, e, validData) {
        var currentObj = obj;
        var currentPage = currentObj.parentNode.parentNode.parentNode.parentNode.getAttribute('data-page');
        /* force page to the next survey */
        if ((currentPage - 1) > nextIndex) {
            nextSurvey();
        }

        if (nextIndex < CountPageSurvey - 1) {
            /* next button visible */
            if (validData) {
                buttonNext.style.marginRight = "0";
                isFilled[nextIndex].push(true);
            } else {
                buttonNext.style.marginRight = "-120px";
                isFilled[nextIndex].pop();
            }

        } else if (nextIndex == CountPageSurvey - 1) {
            if (validData) {
                buttonSumbit.style.marginRight = "0";
                isFilled[nextIndex].push(true);
            } else {
                buttonSumbit.style.marginRight = "-120px";
                isFilled[nextIndex].pop();
            }
        }
    }

    function checkbutton() {
        var inputfield = document.querySelectorAll(".page")[nextIndex].querySelectorAll(".wall-container .wall-form-control .wall-input-control input");
        var regex = /^\\s/g;
        var str = inputfield[0].value;
        if (regex.exec(str) == null && str.length > 0 ) {
            if (nextIndex == CountPageSurvey - 1) {
                showSubmit()
            } else {
                buttonNext.style.marginRight = "0";
            }
        } else {
            if (nextIndex == CountPageSurvey - 1) {
                /* showSubmit() */
            } else {
                buttonNext.style.marginRight = "-100px";
            }
        }
    }

    function nextSurvey(e) {
        e = e || window.event;
        var node = e.target.nodeName;
        var targetId = e.target.id;

        /* check next index value */
        if (nextIndex < CountPageSurvey - 1) {
            isFilled[nextIndex].push(true);
            /* if correct prev button show */
            buttonPrev.style.opacity = "1";
            buttonPrev.style.marginLeft = "0";


            /* prev = old next */
            prevIndex = nextIndex;

            /* new next index ++ */
            nextIndex += 1;
            currentIndex = nextIndex; /*NEW*/

            /* show or hide next btn */
            showNext(nextIndex);
            showSubmit();

            /* slide page to left */
            pages[nextIndex - 1].style.marginLeft = "-100%";

            /* set text for 1/4 for example */
            indexSurvey.innerHTML = nextIndex + 1;
            /*
            check if next = total question page
            or it page is the last
            */


        } else if (nextIndex == CountPageSurvey - 1) {
            isFilled[nextIndex].push(true);
            /* showing submit */
            showSubmit();
            /* buttonSumbit.style.marginRight = "0"; */
        }
        /* get action to radio button */
        if (document.getElementById(targetId) !== null) {
            if (targetId != "control-next" || node != "P" || node != "IMG") {
                document.getElementById(targetId).previousSibling.checked = true;
            }
        }
    }

    function prevSurvey() {
        /* check index prev */
        if (prevIndex >= 0) {
            /*
             if MT 0
             show prev index 
            */
            pages[prevIndex].style.marginLeft = "0%";

            indexSurvey.innerHTML = prevIndex + 1;
            /*
             if prev index is undefined
             happne in first page 
            */
            if (prevIndex != undefined) {

                /* new next is old prev value */
                nextIndex = prevIndex;
                /* prev index -- */
                prevIndex -= 1;
                currentIndex = prevIndex;
                if (prevIndex < 0) {
                    /* hide prev */
                    buttonSumbit.style.marginRight = "-100%";
                    buttonPrev.style.marginLeft = "-100%";

                } else if (nextIndex < CountPageSurvey - 1) {
                    /* hide submit */
                    buttonSumbit.style.marginRight = "-100%";
                }
            }
            showNext(nextIndex);
            buttonNext.style.marginRight = "0";

        } else if (prevIndex == undefined || prevIndex < 0) {
            /* surveyGatwayDiv.style.marginLeft = "0%"; */

        }
    }

    function showNext(index) {
        if (checkRadio[index].length == 0) {
            buttonNext.style.marginRight = "-100%";
        } else {
            buttonNext.style.marginRight = "0%";
        }
    }

    function showPopup(data, type, id) {
        popupSurvey.style.visibility = "visible";
        popupSurvey.style.opacity = 1;
        var newcolor = dfpGradientColor.split(",")

        document.querySelector("#wall-popup-content iframe").style.display = "block";
        document.querySelector("#wall-popup-content iframe").src = data;
        document.querySelector("#wall-popup-footer").innerHTML = "<button class='btn vote' style='background : " + newcolor[0] + "' onclick='vote('" + id + "')'>VOTE</button>";
    }

    function closePopup() {
        document.querySelector("#wall-popup-content iframe").style.display = "none";
        document.querySelector("#wall-popup-content iframe").src = "";
        popupSurvey.style.opacity = 0;
        popupSurvey.style.visibility = "hidden";
    }

    function vote(id) {

        isFilled[nextIndex].push(true);
        document.getElementById(id).checked = true;
        closePopup();
        if (nextIndex < CountPageSurvey - 1) {
            nextSurvey()
        } else if (nextIndex == CountPageSurvey - 1) {
            showSubmit();
        }
    }

    function showSubmit() {
        if (isFilled[CountPageSurvey - 1].length == 0) {
            buttonSumbit.style.marginRight = "-100%";
        } else {
            if (nextIndex == CountPageSurvey - 1) {
                buttonSumbit.style.marginRight = "0";
            }
        }
    }

    function submit() {
        var data = JSON.stringify(generateAnswer());
        var xhr = new XMLHttpRequest();
        xhr.addEventListener("readystatechange", function() {
            if (this.readyState == 4) {
                if (this.response.status == "success") {
                    document.querySelector("#wallboard .wallboard-survey .wallboard-survey-success .content p").innerHTML = jsonData.result.description;

                    var nowDate = new Date();
                    nowDate.setDate(nowDate.getDate() + 100);
                    cookieExpires = nowDate.toGMTString();
                    setCookie("wallboard-survey-" + dfpCampaignName, false, "/", cookieExpires);

                }

            }
        });

        if (databacktopage === null) {
            console.log(data)
            surveyContentDiv.style.marginLeft = "-100%";
            xhr.open('POST', dfpUrlsubmit, true);
            xhr.setRequestHeader("content-type", "application/x-www-form-urlencoded");
            xhr.send(data);
            xhr.responseType = 'json';
            console.log("if clause");

        } else {
            console.log("else clause" + databacktopage);
            prevIndex = databacktopage - 1;
            prevSurvey();
            databacktopage = null;
        }
    }

    function generateAnswer() {
        var myform = document.getElementById("wallboard-form");

        var answer = {};
        for (var i = 0; i < jsonData.survey.length; i++) {
            if (jsonData.survey[i].option_type == "text") {

                answer[jsonData.survey[i].id] = {};
                var y = 0;
                for (var x = 0; x < jsonData.survey[i].answers.length; x++) {
                    if (myform.elements["page-" + i][x].checked) {

                        answer[jsonData.survey[i].id][y] = myform.elements["page-" + i][x].value;
                        if (myform.elements["page-" + i][x].value == 1754) {
                            createTracker("women");
                        }
                        y++;
                    }
                }


            } else {

                if (jsonData.survey[i].option_type == "written_answer" || jsonData.survey[i].option_type == "date2") {
                    var regex = /^\\s\\S+|^\\S/g;
                    var str = myform.elements["page-" + i].value;
                    var m;
                    if (regex.exec(str) == null) {
                        var myindex = document.getElementsByName("page-" + i)[0].parentElement.parentElement.parentElement.parentElement.dataset;
                        databacktopage = myindex.page;
                    } else {
                        answer[jsonData.survey[i].id] = myform.elements["page-" + i].value;
                    }
                } else {
                    for (var x = 0; x < jsonData.survey[i].answers.length; x++) {
                        if (myform.elements["page-" + i][x].checked) {}
                    }
                }

            }
        }

        answer = JSON.stringify(answer);

        var jsonSend = {
            "interactive_content_id": jsonData.id,
            "interactive_page": jsonData.id,
            "tracking_id": jsonData.tracking_id,
            "profiling_answer": [],
            "is_finished": 1,
            "interactive_result_id": 0,
            "action": "tracking",
            answer
        }
        return jsonSend;
    }

    function generateAutocomplate() {
        var datakota = ["Langsa", "Lhokseumawe", "Sabang", "Banda Aceh", "Bener Meriah", "Aceh Tamiang", "Nagan Jaya", "Aceh Jaya", "Gayo Lues", "Aceh Barat Daya", "Bireun", "Aceh Singkil", "Simeulue", "Aceh Utara", "Pidie", "Aceh Besar", "Aceh Barat", "Tengah", "Aceh Timur", "Aceh Tenggara", "Aceh Selatan", "Padang Sidempuan", "Tebing Tinggi", "Binjai", "Tanjung Balai", "Sibolga", "Pematang Siantar", "Medan", "Serdang Bedagai ", "Samosir ", "Humbang Hasundutan", "Pakpak Barat", "Nias Selatan", "Mandailing Natal", "Toba Samosir", "Dairi", "Labuhan Batu", "Asahan", "Simalungun", "Deli Serdang", "Karo", "Langkat", "Nias", "Tapanuli Selatan", "Tapanuli Utara", "Tapanuli Tengah", "Pariaman", "Payakumbuh", "Bukittinggi", "Padang Panjang", "Sawhlunto", "Solok", "Padang", "Pasaman Barat ", "Solok Selatan ", "Dharmasraya", "Kepulauan Mentawai", "Pasaman ", "Lima Puluh ", "Agam", "Padang Pariaman", "Tanah Datar", "Sw.lunto", "Solok", "Kab.pesisir Selatan", "Dumai", "Pekan Baru", "Kuantan Singingi", "Siak", "Rokan Hilir", "Rokan Hulu", "Pelalawan", "Indragiri Hilir", "Bengkalis", "Indragiri Hulu", "Kampar", "Kerinci", "Tebo", "Bungo", "Tanjung Jabung Timur", "Tanjung Jabung Barat", "Muaro Jambi", "Sarolangun", "Merangin", "Prabumulih", "Lubuk Linggau", "Pagar Alam", "Palembang", "Ogan Ilir ", "Oku Selatan ", "Oku Timur ", "Banyuasin", "Musi Banyuasin", "Musi Rawas", "Lahat", "Muara Enim", "Ogan Komering Ilir ", "Ogan Komering Ulu ", "Bengkulu", "Kepahiang ", "Lebong ", "Muko Muko", "Seluma", "Kaur", "Bengkulu Utara", "Rejang Lebong ", "Bengkulu Selatan", "Metro", "Bandar Lampung", "Way Kanan", "Lampung Timur", "Tanggamus", "Tulang Bawang", "Lampung Barat", "Lampung Utara", "Lampung Tengah", "Lampung Selatan", "Pangkal Pinang", "Bangka Timur", "Bangka Barat", "Bangka Tengah", "Bangka Selatan", "Belitung", "Bangka", "Tanjung Pinang", "Batam", "Lingga ", "Natuna", "Karimun", "Kepulauan Riau ", "Jakarta Timur", "Jakarta Selatan", "Jakarta Barat", "Jakarta Utara", "Jakarta Pusat", "Kep Seribu", "Banjar", "Tasikmalaya", "Cimahi", "Depok", "Bekasi", "Cirebon", "Bandung", "Sukabumi", "Bogor", "Bekasi", "Karawang", "Purwakarta", "Subang", "Indramayu", "Sumedang", "Majalengka", "Cirebon", "Kuningan", "Ciamis", "Tasikmalaya", "Garut", "Bandung", "Cianjur", "Sukabumi", "Bogor", "Tegal", "Pekalongan", "Salatiga", "Surakarta", "Magelang", "Brebes", "Tegal", "Pemalang", "Pekalongan", "Batang", "Kendal", "Temanggung", "Semarang", "Demak", "Jepara", "Kudus", "Pati", "Rembang", "Blora", "Grobogan", "Sragen", "Karanganyar", "Wonogiri", "Sukoharjo", "Klaten", "Boyolali", "Magelang", "Wonosobo", "Purworejo", "Kebumen", "Banjarnegara", "Purbalingga", "Banyumas", "Cilacap", "Yogyakarta", "Sleman", "Gunung Kidul", "Bantul", "Kulon Progo", "Batu", "Surabaya", "Madiun", "Mojokerto", "Pasuruan", "Probolinggo", "Malang", "Blitar", "Kediri", "Sumenep", "Pamekasan", "Sampang", "Bangkalan", "Gresik", "Lamongan", "Tuban", "Bojonegoro", "Ngawi", "Magetan", "Madiun", "Nganjuk", "Jombang", "Mojokerto", "Sidoarjo", "Pasuruan", "Probolinggo", "Situbondo", "Bondowoso", "Jember", "Lumajang", "Kediri", "Blitar", "Tulungagung", "Trenggalek", "Ponorogo", "Pacitan", "Cilegon", "Tangerang", "Serang", "Tangerang", "Lebak", "Pandeglang", "Denpasar", "Buleleng", "Karangasem", "Bangli", "Klungkung", "Gianyar", "Badung", "Tabanan", "Jembarana", "Bima", "Mataram", "Sumbawa Barat", "Bima", "Dompu", "Sumbawa ", "Lombok Timur", "Lombok Tengah", "Lombok Barat", "Kupang", "Manggarai Barat", "Rote Ndao", "Lembata", "Sumba Barat", "Sumba Timur", "Manggarai", "Ngada", "Ende", "Sikka", "Flores Timur", "Alor", "Belu", "Timor Tengah Utara", "Timor Tengah Selatan", "Kupang", "Singkawang", "Pontianak", "Sekadau ", "Melawi ", "Landak", "Bengkayang", "Kapuas Hulu", "Sintang ", "Ketapang", "Sanggau ", "Pontianak", "Sambas", "Palangkaraya", "Barito Timur", "Murung Raya", "Pulang Pisau", "Gunung Mas", "Lamandau", "Sukamara", "Seruyan", "Katingin", "Barito Utara", "Barito Selatan", "Kapuas", "waringin Timur", "Banjarbaru", "Banjarmasin", "Balangan", "Tanah Bambu", "Tabalong", "Hulu Sungai Utara", "Hulu Sungai Tengah", "Hulu Sungai Selatan", "Tapin", "Barito Kuala", "Banjar", "baru", "Tanah Laut", "Bontang", "Tarakan", "Samarinda", "Balikpapan", "Penajam Paser Utara", "Kutai Timur", "Kutai Barat", "Malinau", "Nunukan", "Bulungan", "Berau", "Kutai Kertanegara", "Pasir", "Tomohon", "Bitung", "Manado", "Minahasa Utara", "Minahasa Selatan", "Kepulauan Talaud", "Kepulauan Sangihe", "Minahasa ", "Bolaang Mangondow", "Palu", "Tojo Una Una", "Parigi Moutong", "Banggai Kepulauan", "Morowali", "Buol", "Toloi Toli", "Donggala", "Poso ", "Banggai", "Palopo", "Pare Pare", "Makasar", "Luwu Timur", "Luwu Utara", "Tana Toraja", "Luwu", "Enrekang", "Pinrang", "Sidenreng Rapang", "Wajo", "Soppeng", "Barru", "Pangkajene Kep.", "Maros", "Bone", "Sinjai", "Gowa", "Takalar", "Jeneponto.", "Bantaeng", "Bulukumba", "Selayar", "Bau Bau", "Kendari", "Kolaka Utara", "Wakatobi", "Bombana", "Konawe Selatan", "Buton", "Muna", "Konawe", "Kolaka", "Gorontalo", "Pahuwato", "Bone Bolango", "Boalemo", "Gorontalo", "Majene", "Polowali Mamasa", "Mamasa", "Mamuju", "Mamuju Utara", "Ambon", "Kepulauan Aru", "Seram Bagian Barat ", "Seram Bagian Timur", "Buru", "Maluku Tenggara Brt", "Maluku Tenggara ", "Maluku Tengah ", "Tidore Kepulauan", "Ternate", "Halmahera Timur", "Kepulauan Sula", "Halmahera Selatan", "Halmahera Utara", "Halmahera Tengah", "Halmahera Barat", "Jayapura", "Supiori", "Asmat", "Mappi", "Boven Digoel", "Waropen", "Tolikara", "Yahukimo", "Pegunungan Bintang", "Keerom", "Sarmi", "Mimika", "Paniai", "Puncak Jaya", "Biak Numfor", "Yapen Waropen", "Nabire", "Jayapura", "Jayawijaya", "Merauke", "Sorong", "Kaima", "Teluk Wondama", "Teluk Bentuni", "Raja Ampat", "Sorong Selatan", "Fak Fak", "Manokwari", "Sorong"];
        if (document.getElementById("Kota Sekolah")) {
            autocomplete(document.getElementById("Kota Sekolah"), datakota);
        }
    }

    function autocomplete(inp, arr) {
        var currentFocus;
        inp.addEventListener("input", function(e) {
            var a, b, i, val = this.value;
            closeAllLists();
            if (!val) {
                return false;
            }
            currentFocus = -1;

            a = document.createElement("DIV");
            a.setAttribute("id", "autocomplete-list");
            a.setAttribute("class", "autocomplete-items");
            this.parentNode.appendChild(a);

            for (i = 0; i < arr.length; i++) {
                if (arr[i].substr(0, val.length).toUpperCase() == val.toUpperCase()) {
                    b = document.createElement("DIV");
                    b.innerHTML = "<strong>" + arr[i].substr(0, val.length) + "</strong>";
                    b.innerHTML += arr[i].substr(val.length);
                    b.innerHTML += "<input type='hidden' value='" + arr[i] + "'>";

                    b.addEventListener("click", function(e) {
                        inp.value = this.getElementsByTagName("input")[0].value;
                        closeAllLists();
                        checkbutton();
                    });
                    a.appendChild(b);
                }
            }
        });

        inp.addEventListener("keydown", function(e) {
            checkbutton()

            var x = document.getElementById("autocomplete-list");
            if (x) x = x.getElementsByTagName("div");
            if (e.keyCode == 40) {
                currentFocus++;
                addActive(x);
            } else if (e.keyCode == 38) { /*up */
                currentFocus--;
                addActive(x);
            } else if (e.keyCode == 13) {
                e.preventDefault();
                if (currentFocus > -1) {
                    if (x) x[currentFocus].click();
                }
            }
        });

        function addActive(x) {
            if (!x) return false;
            removeActive(x);
            if (currentFocus >= x.length) currentFocus = 0;
            if (currentFocus < 0) currentFocus = (x.length - 1);
            x[currentFocus].classList.add("autocomplete-active");
        }

        function removeActive(x) {
            for (var i = 0; i < x.length; i++) {
                x[i].classList.remove("autocomplete-active");
            }
        }

        function closeAllLists(elmnt) {
            var x = document.getElementsByClassName("autocomplete-items");
            for (var i = 0; i < x.length; i++) {
                if (elmnt != x[i] && elmnt != inp) {
                    x[i].parentNode.removeChild(x[i]);
                }
            }
        }

        document.addEventListener("click", function(e) {
            closeAllLists(e.target);
        });
    }


    function validationEmail(mail) {
        var cb = false;
        if (/^\\w+([\\.-]?\\w+)*@\\w+([\\.-]?\\w+)*(\\.\\w{2,3})+$/.test(mail)) {
            cb = true;
        } else {
            cb = false;
        }
        return cb;
    }

    function validateNumber(num) {
        if (/^[0-9]*$/.test(num) && parseInt(num) !== 0) {
            return (true)
        } else {
            return (false)
        }
    }

    function WS_setviewport() {
        setTimeout(function(){
            var scrollNode = document.scrollingElement || document.documentElement;
            var scrollTop = scrollNode.scrollTop;
            scrollTop.scrollTop = wallboardDiv.offsetTop - document.activeElement.offsetTop
        },1000);
    }

    var wallboardPosition = false;
    window.addEventListener('scroll', function(){
        if (isWallboardInViewport(wallboardDiv)) {
            wallboardPosition = true;
        }else{
            wallboardPosition = false;
        }
    });

    function isWallboardInViewport(el) {
        var rect = el.getBoundingClientRect();
        return (
            rect.top >= -75 &&
            rect.left >= 0 &&
            rect.bottom <= (window.innerHeight + 300 || document. documentElement.clientHeight + 300) &&
            rect.right <= (window.innerWidth || document. documentElement.clientWidth)
        );
    }

    function wallboardSetScrolltopOnRotate() {
        if (wallboardPosition) {
            setTimeout(function () {
                document.body.scrollTop = wallboardDiv.offsetTop + 100;
                document.documentElement.scrollTop = wallboardDiv.offsetTop + 100;
            }, 500)
        }
    }

    window.addEventListener("orientationchange", wallboardSetScrolltopOnRotate, false);

    function createTracker(cat) {
        var a = document.createElement("img");
        a.setAttribute("src", "https://beacon.krxd.net/event.gif?event_id=M361oCpv&event_type=registration&cat="+cat+"&media=banner");
        a.setAttribute("style", "display:none");
        console.log(a);
        document.body.appendChild(a);
    }

  `;

  var htmltemplate = `\
    <div id="wallboard">
        <div class="wallboard-survey">
            <div class="wall-item wallboard-survey-gateway">
                <div class="item-content">
                    <h3></h3>
                    <div class="control">
                        <div id="msg-gateway"></div>
                    </div>
                </div>
            </div>
            <div class="wall-item wallboard-survey-content">
                <div class="item-content">
                    <form id="wallboard-form" method="get">
                        <div class="content">
                        </div>
                    </form>
                    <div class="control">
                        <button class="btn" id="control-prev" onclick="prevSurvey()">
                          <img src="%%FILE:PNG2%%" alt="">
                        </button>
                        <button class="btn" id="control-next" onclick="nextSurvey()">
                          <img src="%%FILE:PNG3%%" alt=""></button>
                        <button class="btn" id="control-submit" onclick="submit()">
                          <img src="%%FILE:PNG1%%" alt="">
                          </button>
                        <p class="index"><span id="index-survey"></span>of<span id="total-survey"></span></p>
                    </div>
                </div>
            </div>
            <div class="wall-item wallboard-survey-success">
                <div class="item-content">
                    <div class="content"> <img src="%%FILE:PNG4%%" alt="">
                        <p class="title"></p>
                    </div>
                </div>
            </div>
            <div class="wall-item wallboard-survey-error"></div>
            <div id="wallboard-popup"> <img src="https://d.kapanlaginetwork.com/banner/preview/2017/12/13/wallboard/survey/close.png" id="close" alt="" onclick="closePopup()">
                <div id="wall-popup-logo"></div>
                <div id="wall-popup-content">
                    <iframe src="" frameborder="0"></iframe>
                </div>
                <div id="wall-popup-footer"></div>
            </div>
        </div>
    </div>`;

  myparent.innerHTML = htmltemplate;

  var script = document.createElement('script');
  script.setAttribute('type', 'text/javascript');
  script.textContent = myscript;
  myparent.appendChild(script);

  var newcss = document.createElement('style');
  newcss.type = 'text/css';
  newcss.textContent = mystyle;
  myparent.appendChild(newcss);
  window.frameElement.parentElement.parentElement.style.height = "50px";
  window.frameElement.parentElement.parentElement.style.margin = "unset";
</script>

